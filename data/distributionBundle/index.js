n(){s>=(e.oldOpacity||1)-.1?e.clearFading&&e.clearFading():(s*=1.1,e.style.opacity=""+s)}),.1*n);e.clearFading=function(){clearInterval(u),e.style.opacity=""+(e.oldOpacity||1),delete e.clearFading}}},n.show=function(e){this.fade(e),e.removeAttribute("aria-hidden")},n.hide=function(e){this.fade(e,0),e.setAttribute("aria-hidden","true")},n.showSpinner=function(){if(this.spinner.length){for(var e,t=F(this.spinner);!(e=t()).done;){var n=e.value;this.show(n)}this.scrollAndFocus(this.spinner[0])}},n.hideSpinner=function(){for(var e,t=F(this.spinner);!(e=t()).done;){var n=e.value;this.hide(n)}},n.updateInputVisibility=function(){var e=f()(E().mark((function e(t){var n,r,i,a,o,s,u,l,c,p;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=this.inputConfigurations[t],r=n.shown,n.shown=!n.showIf||Boolean(n.showIf()),i=F(this.inputConfigurations[t].domNodes);!(a=i()).done;)a.value.shown=n.shown;if(n.shown===r){e.next=15;break}if(this.resolvedConfiguration.debug&&(Boolean(r)===r?console.debug('Update input "'+t+'" visibility state from "'+(r?"show":"hide")+'" to "'+(n.shown?"show":"hide")+'".'):console.debug('Initialize input "'+t+'" visibility state to "'+(n.shown?"show":"hide")+'".')),!n.shown&&!this.resolvedConfiguration.showAll){e.next=10;break}for(o=F(this.inputConfigurations[t].domNodes);!(s=o()).done;)u=s.value,this.show(u);e.next=14;break;case 10:if("resetOnHide"!==n.valuePersistence){e.next=13;break}return e.next=13,this.resetInput(t);case 13:for(l=F(this.inputConfigurations[t].domNodes);!(c=l()).done;)p=c.value,this.hide(p);case 14:return e.abrupt("return",!0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateAllGroups=function(){for(var e,t=F(this.groups);!(e=t()).done;){var n,r,i=e.value,a=i[0],o=i[1],s=null!==(n=null!==(r=a.getAttribute("name"))&&void 0!==r?r:a.getAttribute("data-name"))&&void 0!==n?n:"unknown",u=a.shown,l=o.childs.filter((function(e){return e.shown}));o.showReason=null,o.showIf?o.showIf(l,o.childs)&&(o.showReason=o.showIfExpression):(l.length||0===o.childs.length)&&(o.showReason=l),a.shown=Boolean(o.showReason),a.shown!==u?(this.resolvedConfiguration.debug&&(Boolean(u)===u?console.debug('Update group "'+s+'" visibility state from "'+(u?"show":"hide")+'" to "'+(a.shown?"show":"hide")+'".'):console.debug('Initialize group "'+s+'" visibility state to "'+(a.shown?"show":"hide")+'".')),a.shown||this.resolvedConfiguration.showAll?(a.style.opacity="0",a.style.display="block",a.shown&&this.updateGroupContent(a),this.fade(a)):this.fade(a,0)):a.shown&&this.updateGroupContent(a)}},n.updateGroupContent=function(e){for(var t=this,n={},r=this.self.baseScopeNames.concat(this.evaluations.map((function(e){return e[0]})),this.inputNames),i=[this.actionResults,this.determineStateURL,this.determinedTargetURL,this.getData,this.initialResponse,this.latestResponse,this.response,this.onceSubmitted,this.pending,this.invalid,this.valid,this.invalidConstraint,this.queryParameters,this.message,P()].concat(this._evaluationResults,this.inputNames.map((function(e){return t.inputConfigurations[e]}))),a=0;a<r.length;a+=1)n[r[a]]=i[a];this.evaluateDomNodeTemplate(e,n,{applyBindings:!1,filter:function(e){return!(e.matches&&(e.matches(t.resolvedConfiguration.selector.groups)||e.matches(t.resolvedConfiguration.selector.inputs)))},ignoreComponents:!1})},n.updateMessageBox=function(e){"string"==typeof e?this.message=e:null===e&&(this.message="");for(var t,n=F(this.statusMessageBoxes);!(t=n()).done;){var r=t.value;this.message?(r.style.display="block",r.textContent=this.message):r.style.display="none"}},t.normalizeURLConfiguration=function(e){var t=P().copy(e),n=t.inputs||{};t.model&&(P().extend(!0,n,t.model),delete t.model);for(var r=0,i=Object.values(n);r<i.length;r++){var a=i[r];a.properties||(a.properties={});for(var o,s=F(["selection","value"]);!(o=s()).done;){var u=o.value;Object.prototype.hasOwnProperty.call(a,u)&&(a.properties[u]=a[u],delete a[u])}Object.prototype.hasOwnProperty.call(a,"nullable")&&(a.properties.required=!a.nullable,delete a.nullable);for(var l,c=F(["mutable","writable"]);!(l=c()).done;){var p=l.value;Object.prototype.hasOwnProperty.call(a,p)&&(a.properties.disabled=!a[p],delete a[p])}}return Object.keys(n).length&&(t.inputs=n),t},t.normalizeEvaluations=function(e){var n=[],r=[],i=[];if(Array.isArray(e))for(var a,o=F(e);!(a=o()).done;){var s=a.value;if(Array.isArray(s)&&s.length>1)i.push([s[0],s[1]]);else if(null!==s&&"object"==typeof s)i=i.concat(Object.entries(s));else if(e.length>1){i=[e.splice(0,2)];break}}else if(null!==e&&"object"==typeof e&&Object.keys(e).length>0){var u=Object.values(e);if(null!==u[0]&&"object"==typeof u[0]&&"number"==typeof u[0].order&&Object.prototype.hasOwnProperty.call(u[0],"evaluations"))for(var l,c=F(u);!(l=c()).done;){var p=l.value;p.order<0?n.push(p):p.order>0?r.push(p):i=t.normalizeEvaluations(p.evaluations)}else i=Object.entries(e)}return i=n.sort((function(e,t){return e.order-t.order})).map((function(e){return t.normalizeEvaluations(e.evaluations)})).flat().concat(i).concat(r.sort((function(e,t){return e.order-t.order})).map((function(e){return t.normalizeEvaluations(e.evaluations)})).flat()),i},t.normalizeConfiguration=function(e){var n=P().copy(e);return n.evaluations=t.normalizeEvaluations(n.evaluations),n.tag||(n.tag={values:[]}),n.tag.values||(n.tag.values=[]),n.tag.values=[].concat(n.tag.values),Object.prototype.hasOwnProperty.call(n,"tags")&&(n.tag.values=n.tag.values.concat(n.tags),delete n.tags),n},n.mergeConfiguration=function(e){var t=this.self.normalizeConfiguration(e);t.evaluations=this.resolvedConfiguration.evaluations.concat(t.evaluations),P().extend(!0,this.resolvedConfiguration,t)},n.resolveConfiguration=function(){this.resolvedConfiguration=this.self.normalizeConfiguration(this.self.defaultConfiguration);for(var e=0,t=[this.baseConfiguration,this.configuration,this.dynamicConfiguration,this.additionalConfiguration];e<t.length;e++){var n=t[e];n&&this.mergeConfiguration(n)}this.urlConfiguration=this.getConfigurationFromURL(),this.urlConfiguration&&this.mergeConfiguration(this.urlConfiguration),this.resolvedConfiguration.initializeTarget=P().extend(!0,P().copy(this.resolvedConfiguration.target),this.resolvedConfiguration.initializeTarget),this.resolvedConfiguration.debug&&console.debug("Got configuration:",P().represent(this.resolvedConfiguration))},n.getConfigurationFromURL=function(){var e=this.queryParameters[this.resolvedConfiguration.name];if("string"==typeof e){var t=P().stringEvaluate(e);if(t.error)return console.warn('Error occurred during processing given url parameter "'+this.resolvedConfiguration.name+'": '+t.error),null;if(null!==t.result&&"object"==typeof t.result)return P().mask(this.self.normalizeURLConfiguration(t.result),this.resolvedConfiguration.urlConfigurationMask)}return null},n.registerActionListener=function(){for(var e=this,t=function(){var t=r[n],i=t[0],a=t[1];if(a.determinedDomNodes=a.domNodes?[].concat(a.domNodes):[],a.globalSelectors)for(var o,s=F(a.globalSelectors);!(o=s()).done;){var u=o.value;a.determinedDomNodes=a.determinedDomNodes.concat(Array.from(document.documentElement.querySelectorAll(u)))}if(a.localSelectors)for(var l,c=F(a.localSelectors);!(l=c()).done;){var p=l.value;a.determinedDomNodes=a.determinedDomNodes.concat(Array.from(e.root.querySelectorAll(p)))}else a.determinedDomNodes=a.determinedDomNodes.concat(Array.from(e.root.querySelectorAll('[action="'+i+'"]')));a.handler=function(t){f()(E().mark((function n(){return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.startBackgroundProcess(t);case 2:return n.next=4,a.run(t,a);case 4:return n.next=6,e.stopBackgroundProcess(t);case 6:case"end":return n.stop()}}),n)})))()};for(var d,h=F(a.determinedDomNodes);!(d=h()).done;){d.value.addEventListener(a.event||"click",a.handler)}},n=0,r=Object.entries(this.resolvedConfiguration.actions);n<r.length;n++)t()},n.configureContentProjectedElements=function(){var e=f()(E().mark((function e(){var t,n,r,i,a,o,s;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="configureContentProjectedElements",e.next=3,this.lock.acquire(t);case 3:return e.next=5,this.connectSpecificationWithDomNodes();case 5:for(n=e.sent,this.registerActionListener(),r=0,i=Object.values(this.inputConfigurations);r<i.length;r++)for(a=i[r].domNodes,o=F(a);!(s=o()).done;)s.value.showInitialValidationState=!1;return e.next=10,this.digest();case 10:return this.preCompileConfigurationExpressions(),this.setGroupSpecificConfigurations(),Object.keys(n).length&&(this.message='Missing input for expected model name "'+Object.keys(n).join('", "')+'".'),this.createDependencyMapping(),this.applyInputBindings(),e.next=17,this.lock.release(t);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.determineInputNames=function(){this.inputNames=Object.keys(this.inputConfigurations).filter((function(e){return!e.includes(".")})).map((function(e){return P().stringConvertToValidVariableName(e)}))},n.connectSpecificationWithDomNodes=function(){var e=f()(E().mark((function e(){var t,n,r,i,a,o,s,u,l,c,d,f,h,g,v,m,b,y,C,x=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Array.from(this.root.querySelectorAll(this.resolvedConfiguration.selector.inputs)),n=t.filter((function(e){return!t.some((function(t){return e!==t&&t.contains(e)}))})),r=0===Object.keys(this.resolvedConfiguration.inputs).length)for(i=F(n);!(a=i()).done;)o=a.value,this.show(o);for(this.inputConfigurations={},s=0,u=Object.entries(this.resolvedConfiguration.inputs);s<u.length;s++)l=u[s],c=l[0],d=l[1],this.inputConfigurations[c]=p()({domNodes:[],name:c,properties:{}},d);f=p()({},this.inputConfigurations),this.determineInputNames(),this.initialData={},h=0,g=E().mark((function e(){var t,n,i,a,o,s,u,l,c,p,d,g,v,b,y,C;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=m.value,!(n=t.getAttribute("name"))){e.next=37;break}if(!Object.prototype.hasOwnProperty.call(x.inputConfigurations,n)){e.next=10;break}x.inputConfigurations[n].domNode=t,x.inputConfigurations[n].domNodes.push(t),delete f[n],x.resolvedConfiguration.debug&&x.inputConfigurations[n].showIfExpression&&t.setAttribute("title",x.inputConfigurations[n].showIfExpression),e.next=20;break;case 10:if(!n.includes(".")){e.next=14;break}x.inputConfigurations[n]={dependsOn:null,domNode:t,domNodes:[t],dynamicExtendExpressions:{value:n},name:n,properties:{},showIfExpression:n},e.next=20;break;case 14:if(!r){e.next=18;break}x.inputConfigurations[n]={dependsOn:null,domNode:t,domNodes:[t],name:n,properties:{}},e.next=20;break;case 18:return x.message='Given input "'+n+'" not found in current configuration. Expected names are: "'+x.inputNames.join('", "')+'".',e.abrupt("return",1);case 20:for(a=x.inputConfigurations[n],t.nodeName.includes("-")&&Object.prototype.hasOwnProperty.call(a.properties,"value")&&(a.properties.initialValue=a.properties.value,delete a.properties.value),t.externalProperties&&(null!=(i=t.externalProperties.model)&&i.dynamicExtendExpressions||t.externalProperties.dynamicExtendExpressions)&&(a.dynamicExtendExpressions||(a.dynamicExtendExpressions={}),P().extend(!0,a.dynamicExtendExpressions,(null==(o=t.externalProperties.model)?void 0:o.dynamicExtendExpressions)||{},t.externalProperties.dynamicExtendExpressions||{})),a.properties.model&&(delete a.properties.model.state,null!=(s=t.externalProperties)&&s.model&&P().extend(!0,a.properties.model,t.externalProperties.model)),u=Object.keys(a.properties).sort((function(e,t){if(e===t)return 0;var n=x.self.knownPropertyOrdering.indexOf(e),r=x.self.knownPropertyOrdering.indexOf(t);return-1===n&&-1===r?e<t?-1:1:n===r?0:-1===n?1:n<r?-1:1})),l=F(u);!(c=l()).done;)"model"!==(p=c.value)&&t.externalProperties&&Object.prototype.hasOwnProperty.call(t.externalProperties,p)?console.debug('Form configuration for input "'+n+'" with property "'+p+'" and value "'+P().represent(a.properties[p])+'" has been shadowed by dom nodes configuration value "'+P().represent(t.externalProperties[p])+'".'):(console.debug('Apply form configuration for input "'+n+'" with property "'+p+'" and value "'+P().represent(a.properties[p])+'".'),t[p]=a.properties[p]);try{Object.defineProperty(a,"value",{get:function(){return a.domNode.value},set:function(e){var n=t.nodeName.toLowerCase();Object.prototype.hasOwnProperty.call(x.self.inputValueMapping,n)&&(e=x.self.inputValueMapping[n](e)),a.properties.value=e;for(var r,i=F(a.domNodes);!(r=i()).done;){r.value.value=e}}})}catch(e){}return e.next=29,x.digest();case 29:if(![null,void 0].includes(t.value)&&!t.pristine||!([null,void 0].includes(t.initialValue)||[null,void 0].includes(a.properties.default)||!a.properties.model||[null,void 0].includes(a.properties.model.default)&&[null,void 0].includes(a.properties.model.value))){e.next=34;break}return a.value=null!==(d=null!==(g=null!==(v=null!==(b=null==(y=a.properties.model)?void 0:y.value)&&void 0!==b?b:a.properties.initialValue)&&void 0!==v?v:t.initialValue)&&void 0!==g?g:a.properties.default)&&void 0!==d?d:null==(C=a.properties.model)?void 0:C.default,e.next=33,x.digest();case 33:console.debug('Derive final initial value for input "'+n+'" to "'+a.value+'".');case 34:x.initialData[n]=t.value,e.next=38;break;case 37:x.message='Missing attribute "name" for '+h+". given input.";case 38:h+=1;case 39:case"end":return e.stop()}}),e)})),v=F(n);case 12:if((m=v()).done){e.next=18;break}return e.delegateYield(g(),"t0",14);case 14:if(!e.t0){e.next=16;break}return e.abrupt("continue",16);case 16:e.next=12;break;case 18:for(this.determineInputNames(),b=0,y=Object.values(this.inputConfigurations);b<y.length;b++)C=y[b],Object.prototype.hasOwnProperty.call(C,"dependsOn")&&null===C.dependsOn&&(C.dependsOn=this.inputNames);return e.abrupt("return",f);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.digest=function(){var e=f()(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=1),n=0;case 2:if(!(n<t)){e.next=8;break}return e.next=5,P().timeout();case 5:n+=1,e.next=2;break;case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.setGroupSpecificConfigurations=function(){var e=this;this.groups=[];for(var t=Array.from(this.root.querySelectorAll(this.resolvedConfiguration.selector.groups)),n=this.self.baseScopeNames.concat("shownSubNodes","subNodes","visibility",this.evaluations.map((function(e){return e[0]})),this.inputNames),r=function(){var r=a[i],o=t.filter((function(e){return r!==e&&r.contains(e)})),s={childs:o.filter((function(e){return!o.some((function(t){return t!==e&&t.contains(e)}))})),showReason:null};if(s.childs=s.childs.concat(Object.values(e.inputConfigurations).map((function(e){return e.domNodes})).flat().filter((function(e){return r.contains(e)&&!s.childs.some((function(t){return t.contains(e)}))}))),r.getAttribute("show-if")||r.getAttribute("data-show-if")){var u=(r.getAttribute("show-if")||r.getAttribute("data-show-if")).replace(/(#039;)|(&amp;)/g,"&").replace(/<br\/>/g,""),l="UNKNOWN";"string"==typeof r.getAttribute("data-name")&&(l=r.getAttribute("data-name")),"string"==typeof r.getAttribute("name")&&(l=r.getAttribute("name")),s.showIfExpression=u;var c=P().stringCompile(u,n),p=c.error,d=c.scopeNames,f=c.templateFunction;p?console.error('Failed to compile "show-if" group expression attribute "'+l+'": '+p):s.showIf=function(t,n){try{return Boolean(f.apply(void 0,[e.actionResults,e.determineStateURL,e.determinedTargetURL,e.getData,e.initialResponse,e.latestResponse,e.response,e.onceSubmitted,e.pending,e.invalid,e.valid,e.invalidConstraint,e.queryParameters,e.message,P(),t,n,0===n.length||t.length>0].concat(e._evaluationResults,e.inputNames.map((function(t){return e.inputConfigurations[t]})))))}catch(e){console.error('Failed to evaluate group "'+l+'" code "'+u+'" with bound names "'+d.join('", "')+'": "'+P().represent(e)+'".')}return!1}}e.groups.push([r,s])},i=0,a=t;i<a.length;i++)r();this.groups.reverse()},n.createDependencyMapping=function(){this.dependencyMapping={};for(var e=0,t=Object.entries(this.inputConfigurations);e<t.length;e++){var n=t[e],r=n[0],i=n[1];if(Object.prototype.hasOwnProperty.call(this.dependencyMapping,"use strict";if("undefined"!=typeof module&&null!==module&&"undefined"!==eval("typeof require")&&null!==eval("require")&&"main"in eval("require")&&"undefined"!==eval("typeof require.main")&&null!==eval("require.main")){var ORIGINAL_MAIN_MODULE=module;module!==eval("require.main")&&"paths"in module&&"paths"in eval("require.main")&&"undefined"!=typeof __dirname&&null!==__dirname&&(module.paths=eval("require.main.paths").concat(module.paths.filter((function(path){return eval("require.main.paths").includes(path)}))))}if(null==window)var window="undefined"==typeof global||null===global?{}:global;!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("@babel/runtime/helpers/applyDecoratedDescriptor"),require("@babel/runtime/helpers/assertThisInitialized"),require("@babel/runtime/helpers/asyncToGenerator"),require("@babel/runtime/helpers/extends"),require("@babel/runtime/helpers/inheritsLoose"),require("@babel/runtime/helpers/initializerDefineProperty"),require("@babel/runtime/helpers/initializerWarningHelper"),require("@babel/runtime/regenerator"),require("clientnode"),require("clientnode/property-types"),require("web-component-wrapper/Web"),require("web-component-wrapper/decorator"));else if("function"==typeof define&&define.amd)define(["@babel/runtime/helpers/applyDecoratedDescriptor","@babel/runtime/helpers/assertThisInitialized","@babel/runtime/helpers/asyncToGenerator","@babel/runtime/helpers/extends","@babel/runtime/helpers/inheritsLoose","@babel/runtime/helpers/initializerDefineProperty","@babel/runtime/helpers/initializerWarningHelper","@babel/runtime/regenerator","clientnode","clientnode/property-types","web-component-wrapper/Web","web-component-wrapper/decorator"],t);else{var n="object"==typeof exports?t(require("@babel/runtime/helpers/applyDecoratedDescriptor"),require("@babel/runtime/helpers/assertThisInitialized"),require("@babel/runtime/helpers/asyncToGenerator"),require("@babel/runtime/helpers/extends"),require("@babel/runtime/helpers/inheritsLoose"),require("@babel/runtime/helpers/initializerDefineProperty"),require("@babel/runtime/helpers/initializerWarningHelper"),require("@babel/runtime/regenerator"),require("clientnode"),require("clientnode/property-types"),require("web-component-wrapper/Web"),require("web-component-wrapper/decorator")):t(e["@babel/runtime/helpers/applyDecoratedDescriptor"],e["@babel/runtime/helpers/assertThisInitialized"],e["@babel/runtime/helpers/asyncToGenerator"],e["@babel/runtime/helpers/extends"],e["@babel/runtime/helpers/inheritsLoose"],e["@babel/runtime/helpers/initializerDefineProperty"],e["@babel/runtime/helpers/initializerWarningHelper"],e["@babel/runtime/regenerator"],e.clientnode,e["clientnode/property-types"],e["web-component-wrapper/Web"],e["web-component-wrapper/decorator"]);for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,(function(e,t,n,r,i,a,o,s,u,l,c,p){return function(){var d=[,function(e){e.exports=r},function(e){e.exports=n},function(e){e.exports=a},function(e){e.exports=t},function(e){e.exports=i},function(t){t.exports=e},function(e){e.exports=o},function(e){e.exports=s},function(e){e.exports=u},function(e){e.exports=l},function(e){e.exports=p},function(e){e.exports=c}],f={};function h(e){var t=f[e];if(void 0!==t)return t.exports;var n=f[e]={exports:{}};return d[e](n,n.exports,h),n.exports}h.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return h.d(t,{a:t}),t},h.d=function(e,t){for(var n in t)h.o(t,n)&&!h.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},h.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},h.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var g={};return function(){h.r(g),h.d(g,{AgileForm:function(){return q},api:function(){return D}});var e,t,n,r,i,a,o,s,u,l,c=h(1),p=h.n(c),d=h(2),f=h.n(d),v=h(3),m=h.n(v),b=h(4),y=h.n(b),C=h(5),x=h.n(C),w=h(6),k=h.n(w),O=(h(7),h(8)),E=h.n(O),R=h(9),P=h.n(R),N=h(10),j=h(11),A=h.n(j),S=h(12),I=h.n(S);function F(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var q=(e=A()({type:N.object}),t=A()({type:N.object}),n=A()({type:N.object}),r=A()({type:N.object}),l=function(e){function t(){var n;return(n=e.call(this)||this).actionResults={},n.clearButtons=[],n.resetButtons=[],n.spinner=[],n.statusMessageBoxes=[],n.submitButtons=[],n.truncateButtons=[],n.dependencyMapping={},n.evaluations=[],n.groups=[],n.determinedTargetURL=null,n.initialData={},n.initialResponse=null,n.latestResponse=null,n.message="",n.response=null,n.inputEventBindings={},n.inputConfigurations={},n.inputNames=[],n.invalid=null,n.invalidConstraint=null,n.onceSubmitted=!1,n.pending=!0,n.submitted=!1,n.valid=null,n.reCaptchaFallbackInput=null,n.reCaptchaFallbackRendered=!1,n.reCaptchaPromiseResolver=function(e){},n.reCaptchaPromise=new Promise((function(e){n.reCaptchaPromiseResolver=e})),n.reCaptchaToken=null,m()(n,"additionalConfiguration",a,y()(n)),m()(n,"baseConfiguration",o,y()(n)),m()(n,"configuration",s,y()(n)),m()(n,"dynamicConfiguration",u,y()(n)),n.resolvedConfiguration={},n.urlConfiguration=null,n.queryParameters=void 0,n.self=t,n.lock=new R.Lock,n._evaluationResults=[],n.onClear=function(e){n.doReset(e,!0)},n.onKeyDown=function(e){var t;if(P().keyCode.ENTER===e.keyCode&&null!=(t=e.target)&&t.closest){var r=e.target.closest(n.resolvedConfiguration.selector.inputs);r&&n.root.contains(r)&&n.onSubmit(e)}},n.onReset=function(e){n.doReset(e,!1)},n.onSubmit=function(e){n.doSubmit(e)},n.onTruncate=function(e){n.doReset(e)},n.doReset=f()(E().mark((function e(t,r){var i,a,o;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===r&&(r=null),t.preventDefault(),t.stopPropagation(),i=0,a=Object.keys(n.inputConfigurations);case 4:if(!(i<a.length)){e.next=17;break}return o=a[i],e.prev=6,e.next=9,n.resetInput(o,r);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),console.warn('Failed to reset input "'+o+'": '+P().represent(e.t0));case 14:i++,e.next=4;break;case 17:case"end":return e.stop()}}),e,null,[[6,11]])}))),n.getData=function(){for(var e={},t=[],r=0,i=Object.entries(n.inputConfigurations);r<i.length;r++){var a=i[r],o=a[0],s=a[1];if(!o.includes(".")){var u,l=s.transformer?s.transformer(s.value):s.value;if(s.shown&&null!=(u=s.domNode)&&u.invalid&&t.push(o),o&&![null,void 0].includes(l))if("object"==typeof l&&Object.prototype.hasOwnProperty.call(s,"dataMapping")){var c=p()({},l,{data:e,inputConfigurations:n.inputConfigurations,name:o,item:l});if("string"==typeof s.dataMapping){var d=P().stringEvaluate(s.dataMapping,c);if(d.error)throw new Error(d.error);e[o]=d.result}else for(var f=0,h=Object.entries(s.dataMapping);f<h.length;f++){var g=h[f],v=g[0],m=g[1],b=P().stringEvaluate(m,c);if(b.error)throw new Error(b.error);e[v]=b.result}}else Array.isArray(l)&&l.every((function(e){return null!==e&&"object"==typeof e&&e&&Object.prototype.hasOwnProperty.call(e,"value")}))?e[o]=l.map((function(e){return e.value})):e[o]=l}}return{data:e,invalidInputNames:t}},n.doSubmit=f()(E().mark((function e(t){var r,i,a,o,s,u,l,c,p,d,f,h,g,v,m,b,y;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.preventDefault(),t.stopPropagation(),!n.submitted&&!n.pending){e.next=5;break}return e.abrupt("return");case 5:return n.invalid=!0,n.invalidConstraint=null,n.valid=!n.invalid,r=n.submitButtons.length?n.submitButtons[0]:t.target,i=!!r&&"_blank"===r.getAttribute("target"),n.setAttribute("submitted",""),n.reCaptchaFallbackRendered&&n.setAttribute("re-captcha-fallback-rendered",""),n.runEvaluations(),e.next=15,n.resetAllHiddenNonPersistentInputs();case 15:if(a=n.getData(),o=a.data,!(s=a.invalidInputNames).length){e.next=21;break}for(u=0,l=Object.values(n.inputConfigurations);u<l.length;u++)for(c=l[u].domNodes,p=F(c);!(d=p()).done;)d.value.showInitialValidationState=!0;n.handleInvalidSubmittedInput(o,s),e.next=60;break;case 21:if(!n.reCaptchaFallbackRendered||!n.reCaptchaFallbackInput.hasAttribute("invalid")){e.next=26;break}n.updateMessageBox("Please do the re-captcha challenge."),n.scrollAndFocus(n.reCaptchaFallbackInput),e.next=60;break;case 26:return e.next=28,n.reCaptchaPromise;case 28:if(e.t0=e.sent,e.t0){e.next=31;break}e.t0="";case 31:n.resolvedConfiguration.reCaptcha.token=e.t0,n.onceSubmitted=n.submitted=!0,n.invalid=!1,n.valid=!n.invalid,f=n.inputNames.map((function(e){return n.inputConfigurations[e]})),h=[n.actionResults,n.determineStateURL,n.determinedTargetURL,n.getData,n.initialResponse,n.latestResponse,n.response,n.onceSubmitted,n.pending,n.invalid,n.valid,n.invalidConstraint,n.queryParameters,n.message,P()].concat(f),g=n.self.baseScopeNames.concat(n.inputNames).reduce((function(e,t,n){return e[t]=h[n],e}),{}),v=F(n.resolvedConfiguration.constraints);case 39:if((m=v()).done){e.next=52;break}if(b=m.value,!(y=P().stringEvaluate(b.evaluation,g)).error){e.next=44;break}throw new Error(y.error);case 44:if(y.result){e.next=50;break}return n.updateMessageBox(b.description),n.invalid=!0,n.invalidConstraint=b,n.valid=!n.invalid,e.abrupt("break",52);case 50:e.next=39;break;case 52:if(!n.valid){e.next=58;break}return n.updateMessageBox(null),e.next=56,n.handleValidSubmittedInput(t,o,i);case 56:e.next=59;break;case 58:n.triggerEvent("invalidSubmit",{reference:{data:o,invalidInputNames:s}});case 59:n.submitted=!1;case 60:e.next=65;break;case 62:e.prev=62,e.t1=e.catch(0),console.warn("Submitting failed: "+P().represent(e.t1));case 65:case"end":return e.stop()}}),e,null,[[0,62]])}))),n.determineStateURL=function(){var e=n.self.normalizeConfiguration(n.urlConfiguration||{});P().isPlainObject(e.inputs)||(e.inputs={});for(var t=0,r=Object.entries(n.inputConfigurations);t<r.length;t++){var i=r[t],a=i[0],o=i[1];!a.includes(".")&&o.domNode&&(o.domNode.dirty||!1!==o.domNode.dirty&&"react"!==o.domNode.constructor.webComponentAdapterWrapped)&&(Object.prototype.hasOwnProperty.call(e.inputs,a)?(e.inputs[a]&&Object.prototype.hasOwnProperty.call(e.inputs[a],"properties")||(e.inputs[a].properties={}),n.inputConfigurations[a].value!==e.inputs[a].properties.value&&(n.determinedStateValueIsNeeded(a)?e.inputs[a].properties.value=o.serializer?o.serializer(o.value):o.value:(delete e.inputs[a].properties.value,0===Object.keys(e.inputs[a].properties).length&&delete e.inputs[a].properties,0===Object.keys(e.inputs[a]).length&&delete e.inputs[a]))):n.determinedStateValueIsNeeded(a)&&(e.inputs[a]={properties:{value:o.serializer?o.serializer(o.value):o.value}}))}0===e.evaluations.length&&delete e.evaluations,0===e.tag.values.length&&delete e.tag.values,0===Object.keys(e.tag).length&&delete e.tag;var s=P().mask(e,n.resolvedConfiguration.urlConfigurationMask);s.inputs&&0===Object.keys(s.inputs).length&&delete s.inputs;var u={encoded:document.URL,plain:decodeURI(document.URL)};if(Object.keys(s).length){for(var l=0,c=Object.entries(u);l<c.length;l++){var p=c[l],d=p[0],f=p[1];u[d]=f.replace(new RegExp("\\?"+n.resolvedConfiguration.name+"=[^&]*&","g"),"?").replace(new RegExp("([&?]"+n.resolvedConfiguration.name+"=[^&]*$)|(&"+n.resolvedConfiguration.name+"=[^&]*)","g"),"")}var h=[],g={};JSON.stringify(s,(function(e,t){return Object.prototype.hasOwnProperty.call(g,e)||(h.push(e),g[e]=null),t})),h.sort();var v=JSON.stringify(s,h,""),m=n.resolvedConfiguration.name+"="+encodeURIComponent(v),b=n.resolvedConfiguration.name+"="+v;u.plain.includes("?")?u.plain.endsWith("?")||u.plain.endsWith("&")||(u.encoded+="&",u.plain+="&"):(u.encoded+="?",u.plain+="?"),u.encoded+=m,u.plain+=b}return u},n.defineGetterAndSetterInterface(),n.queryParameters=P().stringGetURLParameter(),n.resolveConfiguration(),n}x()(t,e);var n=t.prototype;return n.attributeChangedCallback=function(t,n,r){e.prototype.attributeChangedCallback.call(this,t,n,r),this.resolveConfiguration()},n.connectedCallback=function(){e.prototype.connectedCallback.call(this),this.updateReCaptchaToken()},n.disconnectedCallback=function(){e.prototype.disconnectedCallback.call(this),this.root.removeEventListener("keydown",this.onKeyDown);for(var t,n=F(this.clearButtons);!(t=n()).done;){t.value.removeEventListener("click",this.onClear)}for(var r,i=F(this.resetButtons);!(r=i()).done;){r.value.removeEventListener("click",this.onReset)}for(var a,o=F(this.submitButtons);!(a=o()).done;){a.value.removeEventListener("click",this.onSubmit)}for(var s,u=F(this.truncateButtons);!(s=u()).done;){s.value.removeEventListener("click",this.onTruncate)}for(var l=0,c=Object.values(this.resolvedConfiguration.actions);l<c.length;l++)for(var p,d=c[l],f=F(d.determinedDomNodes);!(p=f()).done;){p.value.removeEventListener(d.event||"click",d.handler)}for(var h=0,g=Object.values(this.inputEventBindings);h<g.length;h++){(0,g[h])()}},n.render=function(){var e=f()(E().mark((function e(t){var n,r,i,a,o,s,u,l;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t="unknown"),this.dispatchEvent(new CustomEvent("render",{detail:{reason:t}}))){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.digest();case 5:return e.next=7,this.configureContentProjectedElements();case 7:for(this.reCaptchaFallbackInput=this.root.querySelector(this.resolvedConfiguration.selector.reCaptchaFallbackInput),this.reCaptchaFallbackInput&&(this.resolvedConfiguration.showAll?this.show(this.reCaptchaFallbackInput):this.hide(this.reCaptchaFallbackInput),this.resolvedConfiguration.debug&&this.updateReCaptchaFallbackToken()),this.spinner=Array.from(this.root.querySelectorAll(this.resolvedConfiguration.selector.spinner)),this.statusMessageBoxes=Array.from(this.root.querySelectorAll(this.resolvedConfiguration.selector.statusMessageBoxes)),this.clearButtons=Array.from(this.root.querySelectorAll(this.resolvedConfiguration.selector.clearButtons)),this.resetButtons=Array.from(this.root.querySelectorAll(this.resolvedConfiguration.selector.resetButtons)),this.submitButtons=Array.from(this.root.querySelectorAll(this.resolvedConfiguration.selector.submitButtons)),this.truncateButtons=Array.from(this.root.querySelectorAll(this.resolvedConfiguration.selector.truncateButtons)),this.root.addEventListener("keydown",this.onKeyDown),n=F(this.clearButtons);!(r=n()).done;)r.value.addEventListener("click",this.onClear);for(i=F(this.resetButtons);!(a=i()).done;)a.value.addEventListener("click",this.onReset);for(o=F(this.submitButtons);!(s=o()).done;)s.value.addEventListener("click",this.onSubmit);for(u=F(this.truncateButtons);!(l=u()).done;)l.value.addEventListener("click",this.onTruncate);return this.updateMessageBox(),e.next=23,this.stopBackgroundProcess(new CustomEvent("rendered",{detail:{reason:t}}));case 23:return e.next=25,this.initialize();case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.fade=function(e,t,n){if(void 0===t&&(t=1),void 0===n&&(n=100),e.clearFading&&e.clearFading(),parseFloat(e.style.opacity)!==t)if(0===t){var r=(0,R.$)(e).Tools("style");if(e.oldDisplay=r.display||"initial","none"===e.oldDisplay&&delete e.oldDisplay,!this.resolvedConfiguration.animation)return void(e.style.display="none");var i=e.style.position;e.style.position="absolute";var a=e.oldOpacity=parseFloat(r.opacity),o=setInterval((function(){a<=t+.1?e.clearFading&&e.clearFading():(a-=.1*a,e.style.opacity=""+a)}),.1*n);e.clearFading=function(){clearInterval(o),e.style.opacity=""+t,e.style.display="none",e.style.position=i,delete e.clearFading}}else{if(e.style.display=e.oldDisplay||"block",!this.resolvedConfiguration.animation)return void(e.style.opacity="1");var s=.1,u=setInterval((functior)||(this.dependencyMapping[r]=[]),i.dependsOn)for(var a,o=F([].concat(i.dependsOn));!(a=o()).done;){var s=a.value;Object.prototype.hasOwnProperty.call(this.dependencyMapping,s)?this.dependencyMapping[s].includes(r)||this.dependencyMapping[s].push(r):this.dependencyMapping[s]=[r]}}},n.preCompileExpressions=function(e,t){var n=this;void 0===t&&(t="transformer");var r=t+"Expression",i=this.inputConfigurations[e];if(i[r]){var a=i[r],o=P().stringCompile(a,this.self.baseScopeNames.concat("self","value",this.evaluations.map((function(e){return e[0]})),i.dependsOn||[])),s=o.error,u=o.scopeNames,l=o.templateFunction;s&&console.error('Failed to compile "'+r+'" "'+e+'": '+s),i[t]=function(t){try{return l.apply(void 0,[n.actionResults,n.determineStateURL,n.determinedTargetURL,n.getData,n.initialResponse,n.latestResponse,n.response,n.onceSubmitted,n.pending,n.invalid,n.valid,n.invalidConstraint,n.queryParameters,n.message,P(),i,t].concat(n._evaluationResults,(i.dependsOn||[]).map((function(e){return n.inputConfigurations[e]}))))}catch(t){console.warn('Failed running "'+r+'" "'+a+'" for field field "'+e+'" with bound names "'+u.join('", "')+'": "'+P().represent(t)+'".')}return t}}},n.preCompileDynamicExtendStructure=function(e){var t=this,n=this.inputConfigurations[e];if(n.dynamicExtendExpressions){n.dynamicExtend={};for(var r=function(){var r,o,s=a[i],u=s[0],l=s[1],c=t.self.baseScopeNames.concat("event","eventName","scope","selfName","self",t.evaluations.map((function(e){return e[0]})),n.dependsOn||[]);if("string"==typeof l){var p=P().stringCompile(l,c);r=p.scopeNames,o=p.templateFunction,p.error&&console.error('Failed to compile "dynamicExtendExpression" for property "'+u+'" in field "'+e+'":',p.error)}else r=c.map((function(e){return P().stringConvertToValidVariableName(e)}));n.dynamicExtend[u]=function(i){for(var a,s={},c=[t.actionResults,t.determineStateURL,t.determinedTargetURL,t.getData,t.initialResponse,t.latestResponse,t.response,t.onceSubmitted,t.pending,t.invalid,t.valid,t.invalidConstraint,t.queryParameters,t.message,P(),i,t.determineEventName(i),s,e,n].concat(t._evaluationResults,(n.dependsOn||[]).map((function(e){return t.inputConfigurations[e]}))),p=0,d=F(r);!(a=d()).done;){s[a.value]=c[p],p+=1}try{return P().isFunction(l)?l(i,s):o.apply(void 0,c)}catch(t){console.error('Failed running "dynamicExtendExpression" "'+l+'" for property "'+u+'" in field "'+e+'" with bound names "'+r.join('", "')+'": "'+P().represent(t)+'".')}}},i=0,a=Object.entries(n.dynamicExtendExpressions);i<a.length;i++)r()}},n.preCompileActions=function(){for(var e=this,t=this.self.baseScopeNames.concat("event","action",this.evaluations.map((function(e){return e[0]})),this.inputNames),n=function(){var n=i[r],a=n[0],o=n[1];o.name||(o.name=a);var s=o.code;if(!o.run&&"fallback"===s.trim())return 1;var u=P().stringCompile(s,t),l=u.error,c=u.scopeNames,p=u.templateFunction;l&&console.error('Failed to compile action expression "'+a+'": '+l),o.run=f()(E().mark((function t(n,r){var i;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=p.apply(void 0,[e.actionResults,e.determineStateURL,e.determinedTargetURL,e.getData,e.initialResponse,e.latestResponse,e.response,e.onceSubmitted,e.pending,e.invalid,e.valid,e.invalidConstraint,e.queryParameters,e.message,P(),n,r].concat(e._evaluationResults,e.inputNames.map((function(t){return e.inputConfigurations[t]})))),null===i||"object"!=typeof i||!("then"in i)){t.next=8;break}return t.next=5,i;case 5:t.t0=t.sent,t.next=9;break;case 8:t.t0=i;case 9:e.actionResults[a]=t.t0,t.next=15;break;case 12:t.prev=12,t.t1=t.catch(0),console.error('Failed running action "'+a+'" expression "'+s+'" with bound names "'+c.join('", "')+'": "'+P().represent(t.t1)+'".');case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))},r=0,i=Object.entries(this.resolvedConfiguration.actions);r<i.length;r++)n()},n.preCompileTargetActions=function(){for(var e=this,t=this.self.baseScopeNames.concat(this.evaluations.map((function(e){return e[0]})),this.inputNames),n=function(){var n=i[r],a=n[0],o=n[1];o.name||(o.name=a);var s=o.code;if(!o.indicator&&"fallback"===s.trim())return 1;var u=P().stringCompile(s,t),l=u.error,c=u.scopeNames,p=u.templateFunction;l&&console.error('Failed to compile target action expression "'+a+'":',l),o.indicator=function(){try{return p.apply(void 0,[e.actionResults,e.determineStateURL,e.determinedTargetURL,e.getData,e.initialResponse,e.latestResponse,e.response,e.onceSubmitted,e.pending,e.invalid,e.valid,e.invalidConstraint,e.queryParameters,e.message,P()].concat(e._evaluationResults,e.inputNames.map((function(t){return e.inputConfigurations[t]}))))}catch(e){console.error('Failed running target action "'+a+'" expression "'+s+'" with bound names "'+c.join('", "')+'": "'+P().represent(e)+'".')}}},r=0,i=Object.entries(this.resolvedConfiguration.targetActions);r<i.length;r++)n()},n.preCompileGenericEvaluations=function(){var e=this;this.evaluations=[];for(var t=this.evaluations.map((function(e){return e[0]})),n=function(){var n=i[r],a=n[0],o=n[1];if("string"!=typeof o)return e.evaluations.push([a,o]),t.push(a),1;var s=P().stringCompile(o,e.self.baseScopeNames.concat(t,e.inputNames)),u=s.error,l=s.scopeNames,c=s.templateFunction;u&&console.error('Failed to compile generic expression "'+a+'": '+u),t.push(a),e.evaluations.push([a,function(){try{return c.apply(void 0,[e.actionResults,e.determineStateURL,e.determinedTargetURL,e.getData,e.initialResponse,e.latestResponse,e.response,e.onceSubmitted,e.pending,e.invalid,e.valid,e.invalidConstraint,e.queryParameters,e.message,P()].concat(e._evaluationResults,e.inputNames.map((function(t){return e.inputConfigurations[t]}))))}catch(e){console.error('Failed running generic expression "'+a+'" "'+o+'" with bound names "'+l.join('", "')+'": "'+P().represent(e)+'"')}}])},r=0,i=this.resolvedConfiguration.evaluations;r<i.length;r++)n()},n.preCompileConfigurationExpressions=function(){this.preCompileGenericEvaluations(),this.preCompileActions(),this.preCompileTargetActions();for(var e=0,t=Object.entries(this.inputConfigurations);e<t.length;e++){var n=t[e],r=n[0],i=n[1];i.dependsOn=[].concat(i.dependsOn||[]);for(var a=0,o=["serializer","transformer","showIf"];a<o.length;a++){var s=o[a];this.preCompileExpressions(r,s)}this.preCompileDynamicExtendStructure(r)}},n.determineEvaluationScope=function(){var e=this;return p()({determineStateURL:this.determineStateURL,queryParameters:this.queryParameters,Tools:P()},Object.fromEntries(this.evaluations.map((function(e){return e[0]})).map((function(t,n){return[t,e._evaluationResults[n]]}))),Object.fromEntries(this.inputNames.map((function(t){return[t,e.inputConfigurations[t]]}))),this.resolvedConfiguration)},n.initialize=function(){var e=f()(E().mark((function e(){var t,n,r,i;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.triggerEvent("initialize",{reference:this.resolvedConfiguration.initializeTarget}),null==(t=this.resolvedConfiguration.initializeTarget)||!t.url){e.next=26;break}return n={target:null},r=new CustomEvent("initialize",{detail:n}),e.next=6,this.startBackgroundProcess(r);case 6:if(n.target=P().evaluateDynamicData(P().copy(this.resolvedConfiguration.initializeTarget),this.determineEvaluationScope()),!n.target.url){e.next=22;break}return e.next=10,this.doRequest(n.target);case 10:if(this.initialResponse=this.latestResponse=e.sent,this.initialResponse){e.next=15;break}return e.next=14,this.stopBackgroundProcess(r);case 14:return e.abrupt("return");case 15:if(!Object.prototype.hasOwnProperty.call(this.resolvedConfiguration.targetActions,"initialize")){e.next=22;break}if(this.runEvaluations(),"string"!=typeof(i=this.resolveTargetAction(this.resolvedConfiguration.targetActions.initialize,"initialize"))){e.next=22;break}return location.href=i,this.triggerEvent("initialized",{target:n.target}),e.abrupt("return");case 22:if(!this.pending){e.next=25;break}return e.next=25,this.stopBackgroundProcess(r);case 25:this.triggerEvent("initialized",{target:n.target});case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.resolveTargetAction=function(e,t){var n=e.indicator();if(n){console.debug('Action "'+t+'" matched'+("boolean"==typeof n?"":' (with result "'+n+'")')+".");var r=e.target;return r=r&&"string"==typeof r?r.trim():"","string"==typeof n&&(/^([a-z]+:)?\/\/.+$/.test(n)?r=n:""===r||r.endsWith("?")||r.endsWith("&")?r+=n:r+=(r.includes("?")?"&":"?")+n),r}return null},n.resetInput=function(){var e=f()(E().mark((function e(t,n){var r,i,a,o,s,u,l;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!1),!Object.prototype.hasOwnProperty.call(this.inputConfigurations,t)){e.next=7;break}if(r=this.inputConfigurations[t],!1===n&&Object.prototype.hasOwnProperty.call(this.initialData,t))for(i=F(r.domNodes);!(a=i()).done;)a.value.value=P().copy(this.initialData[t]);else if(n&&Object.prototype.hasOwnProperty.call(r.properties,"default"))for(o=F(r.domNodes);!(s=o()).done;)s.value.value=P().copy(r.properties.default);else for(u=F(r.domNodes);!(l=u()).done;)l.value.value=null;return e.next=6,this.digest();case 6:return e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.getOffset=function(e){var t=document.documentElement,n=e.getBoundingClientRect();return{left:n.left+window.pageXOffset-t.clientLeft,top:n.top+window.pageYOffset-t.clientTop}},n.scrollAndFocus=function(e,t){var n=this;return void 0===t&&(t=!0),new Promise((function(r){var i=n.getOffset(e),a=Math.max(0,i.top-n.resolvedConfiguration.offsetInPixel),o=function t(){window.pageYOffset.toFixed()===a.toFixed()&&(window.removeEventListener("scroll",t),"function"==typeof e.focus&&e.focus(),r())};window.addEventListener("scroll",o),o(),0===P().maximalSupportedInternetExplorerVersion&&t?window.scrollTo({behavior:"smooth",top:a}):(window.scrollTo(0,a),o())}))},n.resetAllHiddenNonPersistentInputs=function(){var e=f()(E().mark((function e(){var t,n,r,i,a;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0,n=Object.entries(this.inputConfigurations);case 1:if(!(t<n.length)){e.next=9;break}if(r=n[t],i=r[0],(a=r[1]).shown||"persistent"===a.valuePersistence){e.next=6;break}return e.next=6,this.resetInput(i);case 6:t++,e.next=1;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.handleInvalidSubmittedInput=function(e,t){this.updateMessageBox('The following inputs are invalid "'+t.join('", "')+'".');var n=Array.from(this.root.querySelectorAll('[name="'+t.join('"], [name="')+'"]'));n.length&&this.scrollAndFocus(n[0])},n.handleValidSentData=function(e,t){void 0===t&&(t=!1),this.triggerEvent("submitSuccessful",{reference:{request:e,response:this.response.data}});var n=!1,r="";this.runEvaluations();for(var i=0,a=Object.entries(this.resolvedConfiguration.targetActions);i<a.length;i++){var o=a[i],s=o[0],u=o[1];if("initialize"!==s)if("fallback"===u.code)r=u.target.trim();else{var l=this.resolveTargetAction(u,s);if("string"==typeof l)return t?window.open(l):(n=!0,location.href=l),l}}return!n&&r?(location.href=r,r):""},n.handleUnsuccessfulSentRequest=function(e,t){e&&406===e.status?this.triggerEvent("serverEMailAddressInvalid",{reference:{request:t,response:e.data}}):e&&[401,403].includes(e.status)?this.triggerEvent("serverAuthenticationInvalid",{reference:{request:t,response:e.data}}):e&&420===e.status?(this.updateReCaptchaFallbackToken()&&this.scrollAndFocus(this.reCaptchaFallbackInput),this.reCaptchaFallbackRendered?this.triggerEvent("reCaptchaFallbackCheckFailed",{reference:{request:t,response:e.data}}):this.triggerEvent("reCaptchaCheckFailed",{reference:{request:t,response:e.data}})):e&&428===e.status?this.triggerEvent("serverFormOutdated",{reference:{request:t,response:e.data}}):this.triggerEvent("serverUnexpected",{reference:{request:t,response:e&&e.data||null}})},n.doRequest=function(){var e=f()(E().mark((function e(t,n){var r,i,a,o,s,u,l,c,d,f;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=null),window.Headers&&Object.prototype.hasOwnProperty.call(t,"options")&&null!==t.options&&Object.prototype.hasOwnProperty.call(t.options,"headers")&&null!==t.options.headers){if(i=new Headers,!(t.options.headers instanceof Headers))for(a=0,o=Object.entries(t.options.headers);a<o.length;a++)s=o[a],u=s[0],l=s[1],["boolean","number","string"].includes(typeof l)&&(""+l).trim()&&i.set(u,l);t.options.headers=i}return null!=(r=t.options)&&r.body&&"string"!=typeof t.options.body&&(t.options.body=JSON.stringify(t.options.body)),c=null,this.updateReCaptchaToken(),e.prev=5,e.next=8,fetch(t.url,t.options||{});case 8:c=e.sent,e.next=16;break;case 11:e.prev=11,e.t0=e.catch(5),d=P().represent(e.t0),console.warn('Could not request "'+t.url+'" "'+d+'".'),c=p()({},t.options,{data:{},headers:new Headers,ok:!1,redirected:!1,status:0,statusText:d,url:t.url});case 16:return e.prev=16,e.next=19,c.text();case 19:(f=e.sent).startsWith(this.resolvedConfiguration.securityResponsePrefix)&&(f=f.substring(this.resolvedConfiguration.securityResponsePrefix.length)),c.data=JSON.parse(f),c.data=P().getSubstructure(c.data,this.resolvedConfiguration.responseDataWrapperSelector.path,this.resolvedConfiguration.responseDataWrapperSelector.optional),e.next=28;break;case 25:e.prev=25,e.t1=e.catch(16),console.warn('Given response could not be interpret as json "'+P().represent(e.t1)+'".');case 28:if(!c){e.next=33;break}if(!c.ok||!c.data){e.next=32;break}return c.data.result&&[401,403,407].includes(c.status)&&this.triggerEvent("serverAuthenticationInvalid",{reference:{request:n,response:c.data}}),e.abrupt("return",c);case 32:this.handleUnsuccessfulSentRequest(c,n);case 33:return e.abrupt("return",c);case 34:case"end":return e.stop()}}),e,this,[[5,11],[16,25]])})));return function(t,n){return e.apply(this,arguments)}}(),n.handleValidSubmittedInput=function(){var e=f()(E().mark((function e(t,n,r){var i;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=!1),this.triggerEvent("validSubmit",{reference:n}),this.runEvaluations(),this.resolvedConfiguration.data=n,this.resolvedConfiguration.targetData=this.mapTargetNames(n),null==(i=P().evaluateDynamicData(P().copy(this.resolvedConfiguration.target),this.determineEvaluationScope()))||!i.url){e.next=19;break}return this.determinedTargetURL=i.url,this.latestResponse=this.response=null,e.next=11,this.startBackgroundProcess(t);case 11:return e.next=13,this.doRequest(i,n);case 13:if(this.latestResponse=this.response=e.sent,!(this.response&&this.response.ok&&this.response.data)){e.next=17;break}if(!this.handleValidSentData(n,r)||r){e.next=17;break}return e.abrupt("return");case 17:e.next=23;break;case 19:return this.determinedTargetURL=null,e.next=22,this.startBackgroundProcess(t);case 22:this.resolvedConfiguration.debug&&console.debug("Retrieved data:",P().represent(n));case 23:return e.next=25,this.stopBackgroundProcess(t);case 25:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),n.mapTargetNames=function(e){for(var t={},n=0,r=Object.entries(e);n<r.length;n++){var i=r[n],a=i[0],o=i[1];Object.prototype.hasOwnProperty.call(this.inputConfigurations,a)&&Object.prototype.hasOwnProperty.call(this.inputConfigurations[a],"target")?"string"==typeof this.inputConfigurations[a].target&&this.inputConfigurations[a].target.length&&(t[this.inputConfigurations[a].target]=o):t[a]=o}return t},n.applyInputBindings=function(){for(var e=this,t={instance:this,name:"UNKNOWN_NAME",Tools:P()},n=function(){var n=i[r],a=n[0],o=n[1];t.name=a;for(var s,u=F(o.domNodes);!(s=u()).done;){var l=s.value;e.applyBindings(l,t)}if(!Object.prototype.hasOwnProperty.call(e.inputEventBindings,a)){for(var c,p=Object.prototype.hasOwnProperty.call(o,"changedEventName")?o.changedEventName:"change",d=P().debounce(f()(E().mark((function t(n){var r;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.digest();case 2:if(n.target&&(e.inputConfigurations[a].domNode?Object.values(e.inputConfigurations).map((function(e){return e.domNodes})).flat().some((function(e){return e.contains(n.target)}))||(e.inputConfigurations[a].domNode=n.target):(e.inputConfigurations[a].domNode=n.target,e.inputConfigurations[a].domNodes.push(n.target))),e.runEvaluations(),!e.dependencyMapping[a].length){t.next=10;break}return r=new R.Lock,t.next=8,r.acquire("digest");case 8:return t.next=10,e.updateInputDependencies(a,n);case 10:if(e.updateAllGroups(),!e.dependencyMapping[a].length){t.next=14;break}return t.next=14,r.release("digest");case 14:case"end":return t.stop()}}),t)}))),400),h=F(e.inputConfigurations[a].domNodes);!(c=h()).done;){c.value.addEventListener(p,d)}e.inputEventBindings[a]=function(){for(var t,n=F(e.inputConfigurations[a].domNodes);!(t=n()).done;){t.value.removeEventListener(p,d)}delete e.inputEventBindings[a]}}},r=0,i=Object.entries(this.inputConfigurations);r<i.length;r++)n()},n.updateAllInputs=function(){var e=f()(E().mark((function e(t){var n,r,i;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0,r=Object.keys(this.inputConfigurations);case 1:if(!(n<r.length)){e.next=8;break}return i=r[n],e.next=5,this.updateInput(i,t);case 5:n++,e.next=1;break;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateInput=function(){var e=f()(E().mark((function e(t,n){var r,i,a,o,s,u,l,c,p,d,f,h,g,v,m,b,y,C;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.runEvaluations(),r=this.inputConfigurations[t],i=!1,!Object.prototype.hasOwnProperty.call(r,"dynamicExtend")){e.next=28;break}a=0,o=Object.entries(r.dynamicExtend);case 5:if(!(a<o.length)){e.next=28;break}if(s=o[a],u=s[0],l=s[1],c=!1,p=u,Object.prototype.hasOwnProperty.call(this.self.specificationToPropertyMapping,u)&&(c=Boolean(this.self.specificationToPropertyMapping[u].invert),p=this.self.specificationToPropertyMapping[u].name),d=p.lastIndexOf("."),f=d>0?p.substring(0,d):[],h=d>0?p.substring(d+1):p,g=P().getSubstructure(r.properties,f),v=g[h],m=l(n),c&&(m=!m),v===m){e.next=25;break}for(i=!0,"value"!==p&&(g[h]=m),console.debug('Change "'+u+'" on "'+t+'" from "'+v+'" to "'+m+'".'),P().getSubstructure(r.properties,f)[h]=m,b=F(r.domNodes);!(y=b()).done;)C=y.value,P().getSubstructure(C,f)[h]=m;return e.next=25,this.digest();case 25:a++,e.next=5;break;case 28:return e.next=30,this.updateInputVisibility(t);case 30:if(e.t0=e.sent,e.t0){e.next=33;break}e.t0=i;case 33:if(!e.t0){e.next=38;break}return e.next=36,this.triggerModelUpdate(t);case 36:return e.next=38,this.updateInputDependencies(t,n);case 38:return e.abrupt("return",i);case 39:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.updateInputDependencies=function(){var e=f()(E().mark((function e(t,n){var r,i,a;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=F(this.dependencyMapping[t]);case 1:if((i=r()).done){e.next=7;break}return a=i.value,e.next=5,this.updateInput(a,n);case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.triggerModelUpdate=function(){var e=f()(E().mark((function e(t){var n,r,i,a;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object.prototype.hasOwnProperty.call(this.inputConfigurations,t)){e.next=19;break}n=F(this.inputConfigurations[t].domNodes);case 2:if((r=n()).done){e.next=17;break}if("function"!=typeof(i=r.value).changeTrigger){e.next=11;break}if(!("then"in(a=i.changeTrigger()))){e.next=9;break}return e.next=9,a;case 9:e.next=15;break;case 11:if(!Object.prototype.hasOwnProperty.call(i,"changeTrigger")){e.next=15;break}return i.changeTrigger=!i.changeTrigger,e.next=15,this.digest();case 15:e.next=2;break;case 17:e.next=20;break;case 19:console.warn('Input node (to update corresponding model) for "'+t+'" not found.');case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.determineEventName=function(e){if(e.detail){if(Array.isArray(e.detail.parameter)&&e.detail.parameter.length){if(e.detail.parameter.length>1&&e.detail.parameter[1]&&"string"==typeof e.detail.parameter[1].type)return e.detail.parameter[1].type;if(e.detail.parameter[0]&&"string"==typeof e.detail.parameter[0].type)return e.detail.parameter[0].type}if("string"==typeof e.detail.type)return e.detail.type}return"string"==typeof e.type?e.type:"unknown"},n.runEvaluations=function(){this._evaluationResults=[];for(var e,t=F(this.evaluations);!(e=t()).done;){var n=e.value;this._evaluationResults.push(P().isFunction(n[1])?n[1]():n[1])}},n.startBackgroundProcess=function(){var e=f()(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showSpinner(),this.pending=!0,this.runEvaluations(),e.next=5,this.updateAllInputs(t);case 5:this.updateAllGroups();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.stopBackgroundProcess=function(){var e=f()(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pending=!1,this.runEvaluations(),e.next=4,this.updateAllInputs(t);case 4:this.updateAllGroups(),this.hideSpinner();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.determinedStateValueIsNeeded=function(e){var t=this.inputConfigurations[e].domNode;return!(!t||t.initialValue&&t.initialValue===t.value||void 0===t.initialValue&&t.value===t.default||!t.default&&!t.value&&"boolean"===t.type&&(!t.selection||!(Array.isArray(t.selection)&&t.selection.length>1||!Array.isArray(t.selection)&&Object.keys(t.selection).length>1)))},n.triggerEvent=function(e,t){return Object.prototype.hasOwnProperty.call(t,"reference")&&(t.reference=P().copy(t.reference)),this.dispatchEvent(new CustomEvent(e,{detail:t}))},n.updateReCaptchaFallbackToken=function(){var e,t,n=this;return window.grecaptcha&&!window.grecaptcha.render&&window.location?(location.reload(),!1):window.grecaptcha&&this.reCaptchaFallbackInput&&(this.resolvedConfiguration.showAll||null!=(e=this.resolvedConfiguration.reCaptcha)&&null!=(e=e.key)&&e.v2&&null!=(t=this.resolvedConfiguration.target)&&t.url)?(this.reCaptchaPromise=new Promise((function(e){n.reCaptchaPromiseResolver=e})),this.reCaptchaFallbackInput.removeAttribute("valid"),this.reCaptchaFallbackInput.setAttribute("invalid",""),this.reCaptchaFallbackRendered?window.grecaptcha.reset():(this.reCaptchaFallbackInput.removeAttribute("dirty"),this.reCaptchaFallbackInput.setAttribute("pristine",""),this.reCaptchaFallbackRendered=!0,window.grecaptcha.render(this.reCaptchaFallbackInput,{callback:function(e){n.reCaptchaToken=e,n.reCaptchaPromiseResolver(n.reCaptchaToken),n.reCaptchaFallbackInput.removeAttribute("invalid"),n.reCaptchaFallbackInput.setAttribute("valid",""),n.reCaptchaFallbackInput.removeAttribute("pristine"),n.reCaptchaFallbackInput.setAttribute("dirty","")},sitekey:this.resolvedConfiguration.reCaptcha.key.v2}),this.show(this.reCaptchaFallbackInput)),!0):(this.reCaptchaPromise=Promise.resolve(null),!1)},n.updateReCaptchaToken=function(){var e,t,n=this;if(this.reCaptchaFallbackRendered)return this.updateReCaptchaFallbackToken(),Promise.resolve(null);if(this.reCaptchaToken&&(this.reCaptchaToken=null,this.reCaptchaPromise=new Promise((function(e){n.reCaptchaPromiseResolver=e}))),window.grecaptcha&&null!=(e=this.resolvedConfiguration.reCaptcha)&&null!=(e=e.key)&&e.v3&&null!=(t=this.resolvedConfiguration.target)&&t.url)try{window.grecaptcha.ready((function(){window.grecaptcha.execute(n.resolvedConfiguration.reCaptcha.key.v3,n.resolvedConfiguration.reCaptcha.action).then((function(e){n.reCaptchaToken=e,n.reCaptchaPromiseResolver(n.reCaptchaToken)}),(function(){n.reCaptchaToken=null,n.reCaptchaPromiseResolver(n.reCaptchaToken)}))}))}catch(e){console.warn('Could not retrieve a re-captcha token: "'+P().represent(e)+'".')}else this.reCaptchaToken=null,this.reCaptchaPromiseResolver(this.reCaptchaToken);return this.reCaptchaPromise},t}(I()),l.baseScopeNames=["actionResults","determineStateURL","determinedTargetURL","getData","initialResponse","latestResponse","response","submitted","pending","invalid","valid","invalidConstraint","queryParameters","stateMessage","Tools"],l.content="<form novalidate><slot></slot></form>",l.defaultConfiguration={actions:{},targetActions:{},animation:!0,constraints:[],data:null,debug:!1,evaluations:[],initializeTarget:{options:{method:"GET"},url:""},inputs:{},name:"aForm",offsetInPixel:85,reCaptcha:{action:{action:"aForm"},key:{v2:"",v3:""},secret:"",skip:!1,token:""},responseDataWrapperSelector:{optional:!0,path:"data"},securityResponsePrefix:")]}',",selector:{clearButtons:"button[clear]",groups:".agile-form__group",inputs:"\n                button[name],\n\n                file-input, generic-input, generic-inputs,\n                requireable-checkbox, slider-input, input,\n\n                select, textarea\n            ".replace(/\n+/g," ").replace(/  +/g," "),reCaptchaFallbackInput:".agile-form__re-captcha-fallback",resetButtons:"button[reset], [type=reset]",spinner:"circular-spinner",statusMessageBoxes:".agile-form__status-message",submitButtons:"button[submit], [type=submit]",truncateButtons:"button[truncate]"},showAll:!1,tag:{secret:"",values:[]},target:{options:{body:{__evaluate__:"targetData"},cache:"no-cache",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json","G-Recaptcha-Response":{__evaluate__:"reCaptcha.token"},"G-Recaptcha-Skip":{__evaluate__:"reCaptcha.skip"},"G-Recaptcha-Skip-Secret":{__evaluate__:"reCaptcha.secret "}},method:"PUT",mode:"cors",redirect:"follow"},url:""},targetData:null,urlConfigurationMask:{exclude:!1,include:{reCaptcha:{secret:!0,skip:!0},tag:!0,tags:!0}},version:1},l.inputValueMapping={"slider-input":function(e){return"number"==typeof e?e:0}},l.specificationToPropertyMapping={},l.knownPropertyOrdering=["model","name","type","maximum","minimum","maximumLength","maximum-length","minimumLength","minimum-length","pattern","invertedPattern","inverted-pattern","emptyEqualsNull","empty-equals-null","required","selection","suggestionCreator","suggestion-creator","suggestSelection","suggest-selection","default","initialValue"],l._name="AgileForm",i=l,a=k()(i.prototype,"additionalConfiguration",[e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=k()(i.prototype,"baseConfiguration",[t],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=k()(i.prototype,"configuration",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=k()(i.prototype,"dynamicConfiguration",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i),D={component:q,register:function(e){return void 0===e&&(e=P().stringCamelCaseToDelimited(q._name)),customElements.define(e,q)}};g.default=D}(),g}()}));